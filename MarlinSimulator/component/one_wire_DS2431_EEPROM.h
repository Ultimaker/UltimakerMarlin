#ifndef ONE_WIRE_DS2431_EEPROM_H
#define ONE_WIRE_DS2431_EEPROM_H

#include "one_wire_DS2482.h"

class OneWireDS2431EEPROM : public OneWireDevice
{
public:
    OneWireDS2431EEPROM(uint64_t serial_number);

    bool present;

    virtual bool reset();
    virtual void write(uint8_t data);
    virtual uint8_t read();
private:
    uint64_t serial_number;
    int state;
    int read_index;
    int write_index;
    uint8_t command[8];
    
    uint8_t data[32 * 4];
    
    static constexpr uint8_t default_data[32 * 4] = {
        0x04, 0x55, 0x6c, 0x74, 0x69, 0x6d, 0x61, 0x6b,
        0x65, 0x72, 0x00, 0x00, 0x00, 0x00, 0x41, 0x41,
        0x20, 0x30, 0x2e, 0x34, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xe7,
        0x10, 0x34, 0x95, 0xe0, 0x46, 0x03, 0x00, 0x47,
        0xe0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x58,
        0x50, 0x6c, 0x9f, 0x0d, 0xe3, 0xaa, 0x4b, 0xd4,
        0xb2, 0xd2, 0x23, 0xe2, 0x42, 0x5b, 0x1a, 0xa9,
        0x00, 0x04, 0x67, 0x00, 0x08, 0xdf, 0x3e, 0x80,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0e,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
    };
};

#endif//ONE_WIRE_DS2431_EEPROM_H
